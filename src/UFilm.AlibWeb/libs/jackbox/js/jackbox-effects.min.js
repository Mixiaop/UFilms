(function(j){function B(){var a=j(this),b=a.data("fx");if(C.hasOwnProperty(b))C[b](a)}function M(a,b){var c=j(this);if("zoom"!==a){var e=parseInt(c.attr("width"),10)||c.width(),f=parseInt(c.attr("height"),10)||c.height(),e=j("<img />").attr({width:e,height:f}).data({fx:a,width:e,height:f,settings:b}).insertAfter(c);if(N)e.one("load.cj",B);e.attr("src",c.attr("data-src"));c.remove()}else if(e=c.attr("data-zoom"))c=j("<img />").data({fx:a,thumb:c,settings:b}).one("load.cj",B),c.attr("src",e)}function u(a, b){var c=j("<canvas />").attr(b).css(O),e=b.width,f=b.height,d=c[0].getContext("2d");d.drawImage(a[0],0,0,e,f);return[c,d,d.getImageData(0,0,e,f)]}function w(a){for(var b=a.length-4,c,e,f;-1<b;)c=b+1,e=c+1,f=0.3*a[b]+0.59*a[c]+0.11*a[e],a[b]=f,a[c]=f,a[e]=f,b-=4}function y(a,b){for(var c=[],e;b--;)c[b]=a[b];for(a=[];0<c.length;)e=Math.random()*c.length|0,a[a.length]=c[e],c.splice(e,1);return a}function P(){var a=j(this),b=a.offset(),c=a.data();c.x=b.left;c.y=b.top;Jacked.tween(c.zoom,{opacity:1}, {mode:"timeline"});a.on("mousemove.cj",Q)}function Q(a){var b=j(this).data(),c=a.pageX-b.x,a=a.pageY-b.y,e=b.image.style,f=b.zoom.style,d=b.ww,h=b.hh;0>c||(c>b.width||0>a||a>b.height)||(f.top=((a<h?0:a>b.bufB?b.snapB:a-h)|0)+"px",f.left=((c<d?0:c>b.bufR?b.snapR:c-d)|0)+"px",e.marginTop=(1.5*-a|0)+"px",e.marginLeft=(1.5*-c|0)+"px")}function R(){var a=j(this).off("mousemove.cj");Jacked.tween(a.data("zoom"),{opacity:0},{mode:"timeline"})}function S(){var a=j(this).data("fx");Jacked.stopTween(a[0]);a.css("opacity", 1);Jacked.tween(a[0],{opacity:0},{ease:"Sine.easeInOut",mode:"timeline"})}function D(a){var b=j(this).data(),c=b.fx,e=c.length,f={opacity:0},d={opacity:1},h={visibility:"hidden",opacity:1},g={ease:"Quad.easeIn",mode:"timeline"};"mouseenter"===a.type?(b.fx=c=y(c,e),f=d={opacity:0}):(f={opacity:1},d={opacity:0});for(;e--;)a=c[e],b=a[1],a=a[0],g.delay=20*e,Jacked.stopTween(a[0]),Jacked.stopTween(b[0]),a.css("opacity",1),b.css(h),Jacked.tween(a[0],f,g),Jacked.tween(b[0],d,g)}function E(){for(var a=j(this).data("fx"), b=a.length,c={},e,f;b--;)e=a[b],f=e.data(),c.left=f.origLeft,c.top=f.origTop,Jacked.tween(e[0],c,{mode:"timeline"})}function F(){var a=j(this).data(),b=a.fx,c=b.length,e=a.cols,f=a.newW,d=a.newH,h={},g;for(a.fx=b=y(b,c);c--;)a=c%e,g=c/e|0,h.left=f*a,h.top=d*g,Jacked.tween(b[c][0],h,{mode:"timeline"})}function G(a){for(var b=j(this).data("fx"),c=b.length,e=c,f,d,h="mouseenter"===a.type,g={ease:"Linear.easeNone",mode:"timeline"},i={opacity:0},l={opacity:1};c--;)a=b[c],f=a[1],d=a[2],a=a[0],Jacked.stopTween(a[0]), Jacked.stopTween(d[0]),Jacked.stopTween(f[0]),a.css("opacity",1),d.css("opacity",1),f.css("opacity",0),h?(g.delay=50*c,Jacked.tween(d[0],i,g),Jacked.tween(a[0],i,g)):(g.delay=50*(e-c),Jacked.tween(d[0],i,g),Jacked.tween(f[0],l,g))}function H(a){var b=j(this).data("fx"),c=b.length,e={duration:400,ease:"Sine.easeOut",mode:"timeline"},f={},d;"mouseenter"===a.type?(d=T,f.opacity=0):(d=U,f.opacity=1);for(;c--;)a=b[c],Jacked.special(a[0],{duration:400,ease:"Sine.easeOut",callback:d}),Jacked.tween(a[1], f,e)}function T(a,b){a.style[s]="rotate("+-180*(1-b)+"deg)";a.cjFx.style[s]="rotate("+180*b+"deg)"}function U(a,b){a.style[s]="rotate("+-180*b+"deg)";a.cjFx.style[s]="rotate("+180*(1-b)+"deg)"}function I(a){var b=j(this).data("fx"),c,e={},f,d,h={duration:400,ease:"Sine.easeOut",mode:"timeline"};if("mouseenter"===a.type){var g=b.length-1;f=V;e.opacity=0;for(a=c=-1;a++<g;)clearTimeout(b[a].cjTimeout),b[a].cjTimeout=setTimeout(function(){c++;d=b[c];Jacked.special(d[0],{ease:"Sine.easeOut",callback:f}); Jacked.tween(d[1],e,h)},50*a)}else{f=W;e.opacity=1;for(c=a=b.length;a--;)clearTimeout(b[a].cjTimeout),b[a].cjTimeout=setTimeout(function(){c--;d=b[c];Jacked.special(d[0],{ease:"Sine.easeOut",callback:f});Jacked.tween(d[1],e,h)},50*a)}}function V(a,b){a.style[s]="rotateX("+-180*(1-b)+"deg)";a.cjFx.style[s]="rotateX("+180*b+"deg)"}function W(a,b){a.style[s]="rotateX("+-180*b+"deg)";a.cjFx.style[s]="rotateX("+180*(1-b)+"deg)"}function J(a){var b=j(this).data("fx"),c,e;if("mouseenter"===a.type){var f= b.length-1;e=X;for(a=c=-1;a++<f;)clearTimeout(b[a].cjTimeout),b[a].cjTimeout=setTimeout(function(){c++;Jacked.special(b[c],{duration:400,ease:"Sine.easeOut",callback:e})},50*a)}else{e=Y;for(c=a=b.length;a--;)clearTimeout(b[a].cjTimeout),b[a].cjTimeout=setTimeout(function(){c--;Jacked.special(b[c],{duration:400,ease:"Sine.easeOut",callback:e})},50*a)}}function X(a,b){var c=1-b;a.style[s]="scale("+b+","+b+")";a.cjFx.style[s]="scale("+c+","+c+")"}function Y(a,b){var c=1-b;a.style[s]="scale("+c+","+c+ ")";a.cjFx.style[s]="scale("+b+","+b+")"}var K={shineContrast:1.5,shineBrightness:30,zoomBorder:"1px solid rgba(0, 0, 0, 0.7)",zoomBorderIE:"1px solid #000",rubixBorder:"3px solid rgba(0, 0, 0, 0.75)",rubixBorderIE:"3px solid #000",cols:4,rows:3,color:"#FFF",reversed:!1},C={shine:function(a){for(var b=a.data(),c=u(a,{width:b.width,height:b.height}),e=c[2],f=c[1],c=c[0],d=b.settings,b=d.shineContrast,d=d.shineBrightness,h=e.data,g=h.length-4,i,j,m,k,n;-1<g;)i=g+1,j=i+1,m=h[g]*b+d,k=h[i]*b+d,n=h[j]* b+d,h[g]=255<m?255:0>m?0:m,h[i]=255<k?255:0>k?0:k,h[j]=255<n?255:0>n?0:n,g-=4;f.putImageData(e,0,0);f.restore();c.css("opacity",0).insertAfter(a);a=a.parent();"inline"===a.css("display")&&a.css("display","inline-block");a.css("position","relative").data("fx",c).on("mouseover.cj",S)},blinds:function(a){for(var b=a.data(),c=b.height,e=b.width,f=b.settings,b=f.cols,d=f.rows,h=f.color,f=b*d,g=Math.ceil(e/b),i=Math.ceil(c/d),l,m,k,n,p,d=[],q,t=j("<div />").css({top:0,left:0,width:e,height:c,overflow:"hidden", position:"absolute"}),r={width:g,height:i,display:"block",overflow:"hidden",position:"absolute"},h={opacity:0,width:g,height:i,display:"block",position:"absolute",backgroundColor:h};f--;)k=f%b,l=f/b|0,m=g*k,n=i*l,r.top=n,r.left=m,l=j("<span />").css(r).appendTo(t),k=j("<span />").css(h).appendTo(l),p=u(a,{width:e,height:c}),q=p[2],m=p[0].css({marginLeft:-m,marginTop:-n}).appendTo(l),w(q.data),p[1].putImageData(q,0,0),d[f]=[l,m,k];c=a.parent();t.insertAfter(a);"inline"===c.css("display")&&c.css("display", "inline-block");c.css("position","relative").data("fx",d).on("mouseenter.cj",G).on("mouseleave.cj",G)},scramble:function(a){var b=a.data(),c=b.height,e=b.width,f=u(a,{width:e,height:c}),d=f[2],h=f[1],g=f[0][0],i,l=b.settings,m=l.reversed,b=l.cols,l=l.rows,k=b*l;i=k;var n=e/b|0,p=c/l|0,q={},t,r=j("<div />").css({top:0,left:0,width:e,height:c,overflow:"hidden",position:"absolute"}),s={width:n,height:p,display:"block",overflow:"hidden",position:"absolute"};for(h.putImageData(d,0,0);k--;)h=k%b,d=k/b| 0,h*=n,d*=p,q.origLeft=h,q.origTop=d,t=f[k]=j("<span />").data(q).appendTo(r),t=j("<canvas />").appendTo(t),t[0].getContext("2d").drawImage(g,h,d,n,p,0,0,n,p);m?(f=y(f,i),g=E,m=F):(g=F,m=E);for(;i--;)h=i%b,d=i/b|0,s.left=n*h,s.top=p*d,f[i].css(s);i=a.parent();"inline"===i.css("display")&&i.css("display","inline-block");i.css({position:"relative",height:c,width:e}).data({fx:f,cols:b,rows:l,newW:n,newH:p}).on("mouseenter.cj",g).on("mouseleave.cj",m);r.insertAfter(a);a.remove()},rubix:function(a){var b= a.data(),c=b.height,e=b.width,f=u(a,{width:e,height:c}),d=f[2],h=f[1],g=f[0][0],i=b.settings,b=i.cols,l=i.rows,m=i.color,k=b*l,n=Math.ceil(e/b),l=Math.ceil(c/l),i=!z?i.rubixBorder:i.rubixBorderIE,c=j("<div />").css({top:0,left:0,width:e,height:c,overflow:"hidden",position:"absolute"}),p,q,e={width:n,height:l,display:"block",overflow:"hidden",position:"absolute"},m={opacity:0,width:n,height:l,border:i,display:"block",position:"absolute",backgroundColor:m,boxSizing:"border-box"};w(d.data);for(h.putImageData(d, 0,0);k--;)d=k%b,h=k/b|0,d*=n,q=l*h,e.left=d,e.top=q,i=j("<span />").css(e).appendTo(c),h=j("<span />").css(m).appendTo(i),p=j("<canvas />").appendTo(i),f[k]=[i,h],p[0].getContext("2d").drawImage(g,d,q,n,l,0,0,n,l);g=a.parent();c.insertAfter(a);"inline"===g.css("display")&&g.css("display","inline-block");g.css("position","relative").data("fx",f).on("mouseenter.cj",D).on("mouseleave.cj",D)},rotate:function(a){var b=a.data(),c=b.height,e=b.width,f={width:e,height:c},d=u(a,f),h=d[0][0],g=d[2],i=d[1], d=b.settings,b=d.cols,d=d.rows,l=b*d,m=Math.ceil(e/b),k=Math.ceil(c/d),n,p,q,t,c=j("<div />").css({top:0,left:0,width:e,height:c,overflow:"hidden"}),e={position:"absolute",overflow:"hidden",display:"block",height:k,width:m},r={position:"absolute",overflow:"hidden",display:"block",height:k,width:m};c[0].style[x]="preserve-3d";r[s]="rotateZ(-180deg)";i.putImageData(g,0,0);i.restore();d=u(a,f);g=d[2];i=d[1];f=d[0][0];w(g.data);for(i.putImageData(g,0,0);l--;)g=l%b,i=l/b|0,g*=m,t=k*i,e.left=r.left=g,e.top= r.top=t,p=j("<span />").css(r).appendTo(c),i=j("<span />").css(e).appendTo(c),q=j("<canvas />").appendTo(p),n=j("<canvas />").appendTo(i),p[0].cjFx=i[0],d[l]=[p[0],n[0]],q[0].getContext("2d").drawImage(h,g,t,m,k,0,0,m,k),n[0].getContext("2d").drawImage(f,g,t,m,k,0,0,m,k);h=a.parent();"inline"===h.css("display")&&h.css("display","inline-block");h.css("position","relative").data("fx",d).on("mouseenter.cj",H).on("mouseleave.cj",H);c.insertAfter(a);a.remove()},flip:function(a){var b=a.data(),c=b.height, e=b.width,f=u(a,{width:e,height:c}),d=f[2],f=f[1],h=b.settings,b=h.cols,g=h.rows,h=b*g,i=Math.ceil(e/b),l=Math.ceil(c/g),m,k,n,p,g=[],q=j("<div />").css({top:0,left:0,width:e,height:c,overflow:"hidden"}),t={position:"absolute",overflow:"hidden",display:"block",height:l,width:i},r={position:"absolute",overflow:"hidden",display:"block",height:l,width:i};m=q[0].style;m[A]="100px";m[x]="preserve-3d";r[s]="rotateX(-180deg)";for(f.putImageData(d,0,0);h--;)f=h%b,d=h/b|0,k=i*f,p=l*d,t.left=r.left=k,t.top= r.top=p,n=j("<span />").css(r).appendTo(q),m=j("<span />").css(t).appendTo(q),f=u(a,{width:e,height:c}),f[0].css({marginLeft:-k,marginTop:-p}).appendTo(n),f=u(a,{width:e,height:c}),d=f[2],k=f[0].css({marginLeft:-k,marginTop:-p}).appendTo(m),w(d.data),f[1].putImageData(d,0,0),n[0].cjFx=m[0],g[h]=[n[0],k[0]];c=a.parent();q.insertAfter(a);"inline"===c.css("display")&&c.css("display","inline-block");c.css("position","relative").data("fx",g).on("mouseenter.cj",I).on("mouseleave.cj",I);a.remove()},scale:function(a){var b= a.data(),c=b.height,e=b.width,f={width:e,height:c},d=u(a,f),h=d[0][0],g=d[2],i=d[1],d=b.settings,b=d.cols,d=d.rows,l=b*d,m=Math.ceil(e/b),k=Math.ceil(c/d),n,p,q,t,c=j("<div />").css({top:0,left:0,width:e,height:c,overflow:"hidden"}),e={position:"absolute",overflow:"hidden",display:"block",height:k,width:m},r={position:"absolute",overflow:"hidden",display:"block",height:k,width:m},d=c[0].style;d[A]="75px";d[x]="preserve-3d";r[s]="scale(0, 0)";i.putImageData(g,0,0);d=u(a,f);g=d[2];i=d[1];f=d[0][0]; w(g.data);i.putImageData(g,0,0);for(i.restore();l--;)g=l%b,i=l/b|0,g*=m,t=k*i,e.left=r.left=g,e.top=r.top=t,s?(p=j("<span />").css(r).appendTo(c),i=j("<span />").css(e).appendTo(c)):(i=j("<span />").css(e).appendTo(c),p=j("<span />").css(r).appendTo(c)),q=j("<canvas />").appendTo(p),n=j("<canvas />").appendTo(i),p[0].cjFx=i[0],d[l]=p[0],q[0].getContext("2d").drawImage(h,g,t,m,k,0,0,m,k),n[0].getContext("2d").drawImage(f,g,t,m,k,0,0,m,k);h=a.parent();c.insertAfter(a);"inline"===h.css("display")&&h.css("display", "inline-block");h.css("position","relative").data("fx",d).on("mouseenter.cj",J).on("mouseleave.cj",J);a.remove()},zoom:function(a){var b=a.data(),c=b.thumb,e=parseInt(c.attr("width"),10)||c.width(),f=parseInt(c.attr("height"),10)||c.height(),d=c.parent(),h=f>>1,g=h>>1,i=e>>1,l=i>>1,b=j("<div />").css({top:0,left:0,opacity:0,width:i,height:h,overflow:"hidden",position:"absolute",border:!z?b.settings.zoomBorder:b.settings.zoomBorderIE}).insertAfter(c).append(a);j("<div />").insertAfter(c).data({ww:l, hh:g,width:e,image:a[0],height:f,zoom:b[0],bufR:e-l-2,bufB:f-g-2,snapR:e-i-2,snapB:f-h-2}).append(c,b).on("mouseenter.cj",P).on("mouseleave.cj",R);"inline"===d.css("display")&&d.css("display","inline-block");d.css("position","relative")}},L="undefined"!==typeof Jacked,z,s,N="getContext"in document.createElement("canvas"),O={position:"absolute",left:0,top:0},x,A,v;L&&(z=Jacked.getIE(),s=Jacked.getTransform());j.fn.jackboxFX=function(a,b){var c;b?(c={},j.extend(c,K),j.extend(c,b)):c=K;if(L)return v|| (v=document.body.style,A="WebkitPerspective"in v?"WebkitPerspective":"MozPerspective"in v?"MozPerspective":"msPerspective"in v?"msPerspective":"perspective"in v?"perspective":null,x="WebkitTransformStyle"in v?"WebkitTransformStyle":"MozTransformStyle"in v?"MozTransformStyle":"msTransformStyle"in v?"msTransformStyle":"transformStyle"in v?"transformStyle":null),this.each(M,[a,c])}})(jQuery);